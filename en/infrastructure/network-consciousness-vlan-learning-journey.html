<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Your Article Title Here - Technical tutorial and guide">
    <meta name="keywords" content="homelab">
    <meta name="author" content="OLYAHYAI">

    <title>Your Article Title Here | Omar LYAHYAI Technical Blog</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/blog.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="dark-theme">
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <header class="header" role="banner">
        <nav class="navbar" role="navigation" aria-label="Main navigation">
            <div class="container">
                <div class="nav-brand">
                    <a href="/index.html" class="logo">
                        <i class="fas fa-terminal"></i>
                        <span>OLYAHYAI</span>
                    </a>
                </div>

                <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>

                <ul class="nav-menu">
                    <li><a href="/index.html#home" class="nav-link">Home</a></li>
                    <li><a href="/index.html#about" class="nav-link">About</a></li>
                    <li><a href="/index.html#projects" class="nav-link">Projects</a></li>
                    <li><a href="/index.html#skills" class="nav-link">Skills</a></li>
                    <li><a href="/blog/index.html" class="nav-link active">Blog</a></li>
                    <li><a href="/index.html#contact" class="nav-link">Contact</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="/fr/infrastructure/network-consciousness-vlan-learning-journey.html" class="lang-toggle" aria-label="Change language">
                        <span class="lang-current">FR</span>
                        <i class="fas fa-globe"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section class="article-header" role="region" aria-label="Article header">
            <div class="container">
                <div class="article-breadcrumb">
                    <nav class="breadcrumb" aria-label="Breadcrumb">
                        <a href="/index.html">Home</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/index.html">Blog</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/infrastructure.html">Infrastructure</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <span>Your Article Title Here</span>
                    </nav>
                </div>

                <h1 class="article-title">Your Article Title Here</h1>

                <div class="article-meta">
                    <div class="article-meta-item">
                        <i class="far fa-calendar"></i>
                        <span>2025-11-19</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="far fa-clock"></i>
                        <span>10 min read</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-folder"></i>
                        <span>Infrastructure</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-tags"></i>
                        <span>homelab</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="article-content" role="region" aria-label="Article content">
            <div class="container">
                <div class="article-body">
                    <!-- 
TEMPLATE - Press Alt+E to apply

UPDATE THESE FIELDS:
- title: "Your Title" (KEEP QUOTES)
- date: "YYYY-MM-DD" (KEEP QUOTES)
- category: infrastructure/network_security/automation_ai/reference
- language: auto (let workflow detect) | en (force English) | fr (force French)
- tags: single-keyword-only (NO COMMAS! Use one word or hyphenated)
- description: "Short summary" (KEEP QUOTES)

CRITICAL RULES:
✅ DO: Keep quotes around title, date, description
✅ DO: Use "auto" for language to let workflow detect from content
✅ DO: Use single word for tags (homelab, pfsense, proxmox)
❌ DON'T: Use commas in tags (breaks YAML!)
❌ DON'T: Remove quotes from title/date/description

The workflow will:
- Detect language automatically from your content
- Generate English + French versions
- Create full HTML with navigation
- Preserve images and links
-->
<h1 id="network-consciousness---ongoing-thoughts-learning-log">Network
Consciousness - Ongoing Thoughts &amp; Learning Log</h1>
<h2 id="project-overview">Project Overview</h2>
<p><strong>Date Started:</strong> October 29, 2025
<strong>Goal:</strong> Document the journey of building a secure homelab
network architecture with VLANs and advanced segmentation strategies.
<strong>Status:</strong> In Progress</p>
<hr />
<h2 id="session-1-initial-architecture-design-vlan-philosophy">Session
1: Initial Architecture Design &amp; VLAN Philosophy</h2>
<h3 id="key-insights">Key Insights</h3>
<ol type="1">
<li><strong>VLANs Are Not Magic</strong> - They’re a tool, not a
complete solution. They work best when combined with:
<ul>
<li>Proper firewall rules (deny by default)</li>
<li>Regular security audits</li>
<li>Monitoring and alerting</li>
<li>Employee/user education (in enterprise) or personal discipline (in
homelab)</li>
</ul></li>
<li><strong>The “Default Deny” Principle</strong> - Instead of opening
everything and closing bad traffic, we:
<ul>
<li>Deny everything by default</li>
<li>Whitelist specific allowed traffic</li>
<li>This inverts the security posture from “open unless blocked” to
“closed unless allowed”</li>
</ul></li>
<li><strong>Real-World Problem:</strong> Initial flat network caused:
<ul>
<li>No visibility into device communication patterns</li>
<li>Compromised devices could reach sensitive data</li>
<li>No natural boundaries between security domains</li>
<li>Difficult to troubleshoot what should/shouldn’t work</li>
</ul></li>
</ol>
<h3 id="architectural-decisions-made">Architectural Decisions Made</h3>
<ul>
<li><strong>5 VLANs vs. 20+:</strong> Started simple rather than
over-engineering</li>
<li><strong>pfSense Choice:</strong> Needed open-source, transparent
firewall with VLAN support</li>
<li><strong>Managed Switch Requirement:</strong> Unmanaged switches
can’t understand VLAN tagging</li>
<li><strong>Wireless Integration:</strong> Separate SSIDs per security
domain, not one network</li>
</ul>
<h3 id="concerns-notes">Concerns &amp; Notes</h3>
<ul>
<li>⚠️ <strong>VLAN Hopping Risk:</strong> Double-tagging attacks
possible if not defended against</li>
<li>⚠️ <strong>Configuration Complexity:</strong> One typo in firewall
rule can break entire segment</li>
<li>⚠️ <strong>Performance Overhead:</strong> Minimal in homelab, but
routing between VLANs adds latency</li>
<li>⚠️ <strong>Legacy Device Compatibility:</strong> Older IoT devices
may not support VLAN tagging properly</li>
</ul>
<hr />
<h2 id="session-2-deep-dive---firewall-rule-philosophy">Session 2: Deep
Dive - Firewall Rule Philosophy</h2>
<h3 id="rules-analysis">Rules Analysis</h3>
<p><strong>IoT VLAN (Most Restrictive):</strong> - Only DNS/NTP outbound
- Why? - IoT devices often do automatic cloud updates - By restricting
to DNS/NTP only, we prevent exfiltration - Control their “phone home”
behavior</p>
<ul>
<li>Specific server access - Why?
<ul>
<li>If IoT needs to reach services, make it explicit</li>
<li>This prevents a compromised bulb from accessing your database</li>
</ul></li>
</ul>
<p><strong>Server VLAN (Moderate Restriction):</strong> - Internal
server-to-server communication - Why? - Kubernetes pods may need to talk
to each other - Databases need client access - But external clients are
restricted</p>
<ul>
<li>Controlled internet access - Why?
<ul>
<li>Server updates (apt, docker pull, etc.)</li>
<li>API calls to external services</li>
<li>But logging/monitoring of outbound connections</li>
</ul></li>
</ul>
<p><strong>Trusted VLAN (Most Permissive):</strong> - Personal devices
get broad access - Why? - Users shouldn’t be constantly blocked by
firewall - But still isolated from untrusted networks - Can access
internet directly without restrictions</p>
<h3 id="critical-realization">Critical Realization</h3>
<p>The firewall rules aren’t just about blocking bad traffic—they’re
about <strong>enforcing trust boundaries</strong>. Each VLAN represents
a trust level, and rules enforce what that trust level can access.</p>
<hr />
<h2 id="session-3-implementation-gotchas-solutions">Session 3:
Implementation Gotchas &amp; Solutions</h2>
<h3 id="problem-1-switch-vlan-1-native-configuration">Problem #1: Switch
VLAN 1 Native Configuration</h3>
<p><strong>Issue:</strong> VLAN 1 is special—it’s the management VLAN by
default <strong>Why it matters:</strong> Misconfiguring this can lock
you out of device management <strong>Solution:</strong> Keep VLAN 1
unused or dedicated to device management access only</p>
<h3 id="problem-2-wifi-ap-integration">Problem #2: WiFi AP
Integration</h3>
<p><strong>Issue:</strong> How do consumer WiFi APs handle VLANs?
<strong>Solution:</strong> Not all do equally well - Enterprise APs
(UniFi, Omada, Aruba): Excellent VLAN support - Consumer APs: Limited or
no VLAN support - Workaround: Use AP’s guest network feature to
approximate isolation</p>
<h3 id="problem-3-dhcp-scopes-per-vlan">Problem #3: DHCP Scopes Per
VLAN</h3>
<p><strong>Issue:</strong> Each VLAN needs its own DHCP scope
<strong>Solution:</strong> pfSense can run DHCP for multiple VLANs -
VLAN 30: 10.0.30.100-200 (IoT) - VLAN 50: 10.0.50.100-200 (Trusted) -
Prevents IP conflicts, allows isolation</p>
<h3 id="problem-4-dns-per-vlan">Problem #4: DNS Per VLAN?</h3>
<p><strong>Question:</strong> Should each VLAN have different DNS?
<strong>Current approach:</strong> Single DNS (10.0.0.1 on firewall),
but could do: - Blocklist DNS for IoT VLAN (prevent malware C&amp;C) -
Content filtering for guest network - Separate DNS for privacy-conscious
VLAN</p>
<hr />
<h2 id="session-4-security-threats-mitigations">Session 4: Security
Threats &amp; Mitigations</h2>
<h3 id="threat-vlan-hopping-802.1q-double-tagging">Threat: VLAN Hopping
(802.1Q Double Tagging)</h3>
<p><strong>How it works:</strong></p>
<pre><code>Attacker sends packet with two VLAN tags:
[outer: VLAN 30] [inner: VLAN 20]
Switch removes outer tag (still in VLAN 30)
Next device sees inner tag and processes as VLAN 20</code></pre>
<p><strong>Mitigation:</strong> 1. Disable switchport trunking on access
ports 2. Set access ports to specific VLAN (not trunk mode) 3. Keep
firmware updated 4. Monitor for unusual VLAN transitions</p>
<h3 id="threat-arp-spoofing-within-vlan">Threat: ARP Spoofing Within
VLAN</h3>
<p><strong>How it works:</strong> Attacker sends fake ARP responses to
redirect traffic <strong>Mitigation:</strong> - Enable DHCP snooping -
Enable Dynamic ARP Inspection (DAI) - Static ARP entries for critical
devices</p>
<h3 id="threat-rogue-dhcp-server">Threat: Rogue DHCP Server</h3>
<p><strong>How it works:</strong> Attacker runs DHCP server, gives
clients wrong gateway <strong>Mitigation:</strong> - DHCP snooping
identifies and blocks rogue DHCP - Trust only authorized DHCP ports -
Monitor for unexpected DHCP activity</p>
<h3 id="threat-legitimate-device-compromise">Threat: Legitimate Device
Compromise</h3>
<p><strong>How it works:</strong> Attacker gains control of IoT device,
uses it to scan network <strong>Mitigation:</strong> This is what VLANs
actually prevent - Compromised device is trapped in its VLAN - Firewall
rules prevent it from reaching other networks - Segmentation limits
blast radius</p>
<hr />
<h2 id="session-5-monitoring-visibility">Session 5: Monitoring &amp;
Visibility</h2>
<h3 id="what-should-we-monitor">What Should We Monitor?</h3>
<ol type="1">
<li><strong>VLAN Transitions</strong>
<ul>
<li>Which devices are sending/receiving on multiple VLANs?</li>
<li>Should normally see only firewall devices doing this</li>
<li>Alert on unexpected cross-VLAN activity</li>
</ul></li>
<li><strong>Firewall Rule Hits</strong>
<ul>
<li>Which rules are being triggered?</li>
<li>Expected: IoT trying to reach non-whitelisted destinations</li>
<li>Unexpected: Trusted devices trying to reach restricted servers</li>
</ul></li>
<li><strong>DNS Queries</strong>
<ul>
<li>What domains are IoT devices trying to reach?</li>
<li>Can detect C&amp;C communication</li>
<li>Can optimize firewall rules based on actual usage</li>
</ul></li>
<li><strong>Bandwidth by VLAN</strong>
<ul>
<li>Normal patterns: Gradual increase</li>
<li>Suspicious patterns: Sudden large transfers</li>
<li>Indicators of data exfiltration</li>
</ul></li>
</ol>
<h3 id="tools-to-use">Tools to Use</h3>
<ul>
<li><strong>pfSense native:</strong> Logs in
<code>/var/log/filter.log</code></li>
<li><strong>Prometheus:</strong> Collect metrics from pfSense</li>
<li><strong>Grafana:</strong> Visualize network traffic patterns</li>
<li><strong>Tcpdump:</strong> Deep packet inspection when needed</li>
</ul>
<hr />
<h2 id="session-6-common-mistakes-to-avoid">Session 6: Common Mistakes
to Avoid</h2>
<h3 id="mistake-1-too-many-vlans-too-soon">Mistake #1: Too Many VLANs
Too Soon</h3>
<p>❌ Creating 20 VLANs for every possible use case ✅ Start with 3-5,
add as needed</p>
<p><strong>Why:</strong> More VLANs = more rules = more places to make
mistakes</p>
<h3 id="mistake-2-forgetting-about-management-access">Mistake #2:
Forgetting About Management Access</h3>
<p>❌ Creating a management VLAN, then being unable to access firewall
✅ Always keep management access clear and documented</p>
<p><strong>Why:</strong> You WILL get locked out if you’re not careful.
Physical reset is painful.</p>
<h3 id="mistake-3-assuming-firewall-rules-just-work">Mistake #3:
Assuming Firewall Rules “Just Work”</h3>
<p>❌ Writing complex rules without testing ✅ Start with “allow all,”
monitor, then gradually restrict</p>
<p><strong>Why:</strong> Rules interact in complex ways. Test in
low-impact first.</p>
<h3 id="mistake-4-not-documenting-vlan-allocation">Mistake #4: Not
Documenting VLAN Allocation</h3>
<p>❌ Creating VLANs verbally, no written record ✅ Keep a spreadsheet:
VLAN ID, Name, IP Range, Purpose, Rules</p>
<p><strong>Why:</strong> You’ll forget by next month. Future you needs
this.</p>
<h3 id="mistake-5-ignoring-physical-security">Mistake #5: Ignoring
Physical Security</h3>
<p>❌ Assuming VLANs prevent physical attacks ✅ Secure physical switch
access, cable management</p>
<p><strong>Why:</strong> Anyone with physical access can bypass VLANs
using port mirroring or ARP spoofing tools</p>
<hr />
<h2 id="session-7-cost-benefit-analysis">Session 7: Cost-Benefit
Analysis</h2>
<h3 id="investment-required">Investment Required</h3>
<table>
<thead>
<tr>
<th>Component</th>
<th>Cost</th>
<th>Necessity</th>
</tr>
</thead>
<tbody>
<tr>
<td>Managed Switch</td>
<td>$200-600</td>
<td>CRITICAL</td>
</tr>
<tr>
<td>pfSense Hardware</td>
<td>$150-400</td>
<td>CRITICAL</td>
</tr>
<tr>
<td>Enterprise WiFi AP</td>
<td>$100-300</td>
<td>RECOMMENDED</td>
</tr>
<tr>
<td>Monitoring Tools</td>
<td>Free-$500</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td><strong>$450-1800</strong></td>
<td><strong>High value</strong></td>
</tr>
</tbody>
</table>
<h3 id="benefit-time-saved">Benefit: Time Saved</h3>
<ul>
<li>Initial setup: 6-8 hours</li>
<li>Monthly maintenance: 30 minutes</li>
<li>Troubleshooting: Faster with clear network boundaries</li>
</ul>
<h3 id="benefit-security-improvement">Benefit: Security Improvement</h3>
<ul>
<li><strong>Before:</strong> One compromised device = full network
access</li>
<li><strong>After:</strong> One compromised device = isolated to its
VLAN, blocked from sensitive resources</li>
</ul>
<h3 id="benefit-learning">Benefit: Learning</h3>
<ul>
<li>Deep understanding of network protocols</li>
<li>Practical security knowledge</li>
<li>Confidence in your infrastructure</li>
</ul>
<hr />
<h2 id="session-8-future-enhancements-to-explore">Session 8: Future
Enhancements to Explore</h2>
<h3 id="short-term-next-3-months">Short-term (Next 3 months)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Implement centralized logging
(Splunk/ELK)</label></li>
<li><label><input type="checkbox" />Set up Prometheus/Grafana for
metrics</label></li>
<li><label><input type="checkbox" />Create automated alert rules for
suspicious traffic</label></li>
<li><label><input type="checkbox" />Document IP/MAC allocation across
all VLANs</label></li>
<li><label><input type="checkbox" />Test failover: What happens if
firewall fails?</label></li>
</ul>
<h3 id="medium-term-3-6-months">Medium-term (3-6 months)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Implement intrusion detection
(Suricata)</label></li>
<li><label><input type="checkbox" />Add network segmentation
documentation to portfolio</label></li>
<li><label><input type="checkbox" />Create automation for rule
testing</label></li>
<li><label><input type="checkbox" />Experiment with micro-segmentation
(host-based)</label></li>
<li><label><input type="checkbox" />Security camera network (separate
VLAN 11)</label></li>
</ul>
<h3 id="long-term-6-12-months">Long-term (6-12 months)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Zero-trust network
architecture</label></li>
<li><label><input type="checkbox" />Implement network access control
(NAC)</label></li>
<li><label><input type="checkbox" />Container network segmentation
(Kubernetes)</label></li>
<li><label><input type="checkbox" />Multi-site segmentation (lab +
raspberry pi clusters)</label></li>
<li><label><input type="checkbox" />Compliance framework (CIS
benchmarks)</label></li>
</ul>
<hr />
<h2 id="session-9-portfolio-angle---why-this-matters">Session 9:
Portfolio Angle - Why This Matters</h2>
<h3 id="for-hiring-managers">For Hiring Managers</h3>
<p>This VLAN project demonstrates: 1. <strong>Security Thinking</strong>
- Not just building, but securing 2. <strong>Systems Thinking</strong> -
Understanding how components interact 3. <strong>Attention to
Detail</strong> - Firewall rules require precision 4.
<strong>Problem-Solving</strong> - Troubleshooting network issues 5.
<strong>Documentation</strong> - Critical for production systems</p>
<h3 id="for-engineers-reviewing-code">For Engineers Reviewing Code</h3>
<p>“They understand network isolation and can probably appreciate
defense-in-depth in software architecture too”</p>
<h3 id="for-sredevops-perspective">For SRE/DevOps Perspective</h3>
<ul>
<li>This person understands infrastructure isolation</li>
<li>Can probably architect Kubernetes network policies well</li>
<li>Thinks about security boundaries early, not as afterthought</li>
</ul>
<hr />
<h2 id="session-10-lessons-observations">Session 10: Lessons &amp;
Observations</h2>
<h3 id="what-went-well">What Went Well</h3>
<p>✅ Choosing pfSense early saved switching later ✅ Starting with
“default deny” principle worked great ✅ Documentation (this file!) is
invaluable ✅ Testing rules individually before final deployment</p>
<h3 id="what-was-harder-than-expected">What Was Harder Than
Expected</h3>
<p>❌ Figuring out DHCP scoping across VLANs ❌ Understanding VLAN
switching vs. routing concepts ❌ WiFi integration (most APs have
limited VLAN support) ❌ Monitoring and visibility setup</p>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol type="1">
<li><strong>Segmentation is about trust, not just blocking</strong></li>
<li><strong>Documentation is as important as configuration</strong></li>
<li><strong>Network security is a practice, not a one-time
setup</strong></li>
<li><strong>Monitoring is MORE important than firewall rules (you can’t
secure what you don’t see)</strong></li>
<li><strong>Keep it simple, then add complexity carefully</strong></li>
</ol>
<hr />
<h2 id="notes-for-future-self">Notes for Future Self</h2>
<p>When you’re frustrating about a firewall rule not working: 1. Check
firewall logs first 2. Verify VLAN tagging on switch 3. Confirm DHCP
scope for that VLAN 4. Use tcpdump to see actual traffic 5. Sleep on it,
solutions come when you’re not staring at the problem</p>
<p>You’ve got this. The fact that you’re documenting this journey means
you’re building real expertise, not just clicking buttons.</p>
<hr />
<p><strong>Last Updated:</strong> October 29, 2025 <strong>Next
Review:</strong> November 12, 2025 (2 weeks to implement feedback)</p>
                </div>

                <div class="article-navigation">
                </div>
            </div>
        </section>
    </main>

    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>OLYAHYAI</h3>
                    <p>Pentester in Training | Cybersecurity Enthusiast</p>
                </div>

                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/index.html#home">Home</a></li>
                        <li><a href="/index.html#about">About</a></li>
                        <li><a href="/index.html#projects">Projects</a></li>
                        <li><a href="/blog/index.html">Blog</a></li>
                    </ul>
                </div>

                <div class="footer-social">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="https://github.com/OLYAHYAI" target="_blank" rel="noopener">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://ma.linkedin.com/in/lyahyai-omar" target="_blank" rel="noopener">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="mailto:contact@olyahyai.com">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 OLYAHYAI. All rights reserved.</p>
                <p>Built with <i class="fas fa-heart"></i> and <i class="fas fa-terminal"></i></p>
            </div>
        </div>
    </footer>

    <button class="back-to-top" aria-label="Back to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/animations.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>