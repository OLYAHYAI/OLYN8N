<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Secure your n8n workflows! Learn deep DNS-01 and TLS configuration using pfSense, Nginx Proxy Manager, and Let's Encrypt for robust public or LAN access.">
    <meta name="keywords" content="homelab">
    <meta name="author" content="OLYAHYAI">

    <title>Securing N8n Workflows Deep Dive Dns Tls | Omar LYAHYAI Technical Blog</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/blog.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="dark-theme">
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <header class="header" role="banner">
        <nav class="navbar" role="navigation" aria-label="Main navigation">
            <div class="container">
                <div class="nav-brand">
                    <a href="/index.html" class="logo">
                        <i class="fas fa-terminal"></i>
                        <span>OLYAHYAI</span>
                    </a>
                </div>

                <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>

                <ul class="nav-menu">
                    <li><a href="/index.html#home" class="nav-link">Home</a></li>
                    <li><a href="/index.html#about" class="nav-link">About</a></li>
                    <li><a href="/index.html#projects" class="nav-link">Projects</a></li>
                    <li><a href="/index.html#skills" class="nav-link">Skills</a></li>
                    <li><a href="/blog/index.html" class="nav-link active">Blog</a></li>
                    <li><a href="/index.html#contact" class="nav-link">Contact</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="/fr/network_security/securing-n8n-workflows-deep-dive-dns-tls.html" class="lang-toggle" aria-label="Change language">
                        <span class="lang-current">FR</span>
                        <i class="fas fa-globe"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section class="article-header" role="region" aria-label="Article header">
            <div class="container">
                <div class="article-breadcrumb">
                    <nav class="breadcrumb" aria-label="Breadcrumb">
                        <a href="/index.html">Home</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/index.html">Blog</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/network_security.html">Network Security</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <span>Securing N8n Workflows Deep Dive Dns Tls</span>
                    </nav>
                </div>

                <h1 class="article-title">Securing N8n Workflows Deep Dive Dns Tls</h1>

                <div class="article-meta">
                    <div class="article-meta-item">
                        <i class="far fa-calendar"></i>
                        <span>2025-11-19</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="far fa-clock"></i>
                        <span>5 min min read</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-folder"></i>
                        <span>Network Security</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-tags"></i>
                        <span>homelab</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="article-content" role="region" aria-label="Article content">
            <div class="container">
                <div class="article-body">
                    <!-- 
TEMPLATE - Press Alt+E to apply

UPDATE THESE FIELDS:
- title: "Your Title" (KEEP QUOTES)
- date: "YYYY-MM-DD" (KEEP QUOTES)
- category: infrastructure/network_security/automation_ai/reference
- language: auto (let workflow detect) | en (force English) | fr (force French)
- tags: single-keyword-only (NO COMMAS! Use one word or hyphenated)
- description: "Short summary" (KEEP QUOTES)

CRITICAL RULES:
✅ DO: Keep quotes around title, date, description
✅ DO: Use "auto" for language to let workflow detect from content
✅ DO: Use single word for tags (homelab, pfsense, proxmox)
❌ DON'T: Use commas in tags (breaks YAML!)
❌ DON'T: Remove quotes from title/date/description

The workflow will:
- Detect language automatically from your content
- Generate English + French versions
- Create full HTML with navigation
- Preserve images and links
-->
<h1 id="securing-my-n8n-workflows-a-deep-dive-into-dns-and-tls">Securing
My n8n Workflows: A Deep Dive into DNS and TLS</h1>
<h2 id="objective">Objective</h2>
<p>Establish <strong>reliable and encrypted</strong> access to n8n (and
associated services) either <strong>publicly</strong> (Let’s Encrypt
DNS-01 challenge) or <strong>on LAN</strong> (Split-DNS + local
certificate).</p>
<h2 id="why-secure-n8n">Why Secure n8n?</h2>
<p>n8n is a powerful automation platform that often handles sensitive
credentials, API keys, and business-critical workflows. Securing access
with proper DNS and TLS ensures:</p>
<ul>
<li><strong>Data Protection</strong>: Encrypted connections prevent
credential interception</li>
<li><strong>Authentication</strong>: Verified certificates prevent
man-in-the-middle attacks</li>
<li><strong>Compliance</strong>: Meets security best practices for
workflow automation</li>
<li><strong>Professional Setup</strong>: Demonstrates infrastructure
maturity</li>
</ul>
<h2 id="architecture-overview">Architecture Overview</h2>
<pre><code>Internet/LAN Clients
       ↓
   pfSense (DNS + Firewall)
       ↓
Nginx Proxy Manager (TLS Termination)
       ↓
   n8n Docker Container (5678)</code></pre>
<h2
id="option-a-public-domain-cloudflare-dns-challenge-lets-encrypt">Option
A: Public Domain + Cloudflare + DNS Challenge (Let’s Encrypt)</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Public domain (can use free services like Freenom)</li>
<li>Cloudflare account (free tier sufficient)</li>
<li>Nginx Proxy Manager deployed</li>
<li>n8n running in Docker</li>
</ul>
<h3 id="step-1-domain-setup-with-cloudflare">Step 1: Domain Setup with
Cloudflare</h3>
<h4 id="register-free-domain-optional">Register Free Domain
(Optional)</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visit Freenom.com</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Register domain: my-portfolio.tk (or similar)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Free domains may have limitations</span></span></code></pre></div>
<h4 id="add-domain-to-cloudflare">Add Domain to Cloudflare</h4>
<ol type="1">
<li>Create Cloudflare account at cloudflare.com</li>
<li>Click <strong>“Add a site”</strong></li>
<li>Enter your domain name</li>
<li>Choose <strong>Free plan</strong></li>
<li>Copy Cloudflare nameservers</li>
</ol>
<h4 id="update-nameservers-at-registrar">Update Nameservers at
Registrar</h4>
<ol type="1">
<li><p>Login to your domain registrar (Freenom, Namecheap,
etc.)</p></li>
<li><p>Navigate to <strong>DNS Management</strong></p></li>
<li><p>Replace existing nameservers with Cloudflare nameservers:</p>
<pre><code>ns1.cloudflare.com
ns2.cloudflare.com</code></pre></li>
<li><p>Wait for propagation (can take up to 24 hours)</p></li>
</ol>
<h3 id="step-2-generate-cloudflare-api-token">Step 2: Generate
Cloudflare API Token</h3>
<ol type="1">
<li>In Cloudflare dashboard, click profile icon</li>
<li>Navigate to <strong>“My Profile”</strong> → <strong>“API
Tokens”</strong></li>
<li>Click <strong>“Create Token”</strong></li>
<li>Use template: <strong>“Edit zone DNS”</strong></li>
<li>Configure permissions:
<ul>
<li><strong>Zone</strong>: DNS Edit</li>
<li><strong>Include</strong>: Specific zone (your domain)</li>
</ul></li>
<li>Click <strong>“Continue to summary”</strong> → <strong>“Create
Token”</strong></li>
<li><strong>Save this token securely</strong> - you’ll only see it
once!</li>
</ol>
<h3 id="step-3-configure-nginx-proxy-manager">Step 3: Configure Nginx
Proxy Manager</h3>
<h4 id="create-dns-record-in-cloudflare">Create DNS Record in
Cloudflare</h4>
<ol type="1">
<li>In Cloudflare, go to <strong>DNS</strong> tab</li>
<li>Add A record:
<ul>
<li><strong>Type</strong>: A</li>
<li><strong>Name</strong>: <code>n8n</code> (or <code>@</code> for root
domain)</li>
<li><strong>IPv4 address</strong>: Your public IP or use Cloudflare
proxy</li>
<li><strong>Proxy status</strong>: ✓ Proxied (orange cloud)</li>
</ul></li>
</ol>
<h4 id="add-proxy-host-in-npm">Add Proxy Host in NPM</h4>
<ol type="1">
<li>Access Nginx Proxy Manager:
<code>http://&lt;npm-ip&gt;:81</code></li>
<li>Click <strong>“Proxy Hosts”</strong> → <strong>“Add Proxy
Host”</strong></li>
<li><strong>Details Tab</strong>:
<ul>
<li><strong>Domain Names</strong>: <code>n8n.my-portfolio.tk</code></li>
<li><strong>Scheme</strong>: <code>http</code></li>
<li><strong>Forward Hostname/IP</strong>: <code>n8n</code> (Docker
container name) or IP</li>
<li><strong>Forward Port</strong>: <code>5678</code></li>
<li><strong>Websockets Support</strong>: ✓ <strong>CRITICAL for
n8n</strong></li>
<li><strong>Block Common Exploits</strong>: ✓</li>
</ul></li>
<li><strong>SSL Tab</strong>:
<ul>
<li><p>Select <strong>“Request a new SSL Certificate”</strong></p></li>
<li><p>Toggle <strong>“Use a DNS Challenge”</strong></p></li>
<li><p><strong>DNS Provider</strong>: Select
<strong>Cloudflare</strong></p></li>
<li><p><strong>Credentials File Content</strong>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">dns_cloudflare_api_token </span><span class="ot">=</span><span class="st"> YOUR_CLOUDFLARE_API_TOKEN</span></span></code></pre></div></li>
<li><p><strong>Email Address</strong>: Your email for Let’s
Encrypt</p></li>
<li><p>Options:</p>
<ul>
<li>✓ Force SSL</li>
<li>✓ HTTP/2 Support</li>
<li>✓ HSTS Enabled</li>
</ul></li>
</ul></li>
<li>Click <strong>Save</strong></li>
</ol>
<h3 id="step-4-verify-access">Step 4: Verify Access</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test DNS resolution</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nslookup</span> n8n.my-portfolio.tk</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test HTTPS access</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://n8n.my-portfolio.tk</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Access in browser</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">https://n8n.my-portfolio.tk</span></span></code></pre></div>
<h3 id="advantages-and-limitations">Advantages and Limitations</h3>
<p><strong>✅ Advantages:</strong> - Valid public SSL certificate -
Automatic renewal every 90 days - No need to open ports 80/443 for
HTTP-01 validation - Works from anywhere with internet access</p>
<p><strong>⚠️ Limitations:</strong> - Requires public domain and DNS
propagation - Depends on external services (Cloudflare, Let’s Encrypt) -
Potential privacy concerns with public exposure</p>
<h2 id="option-b-local-dns-pfsense-local-certificate">Option B: Local
DNS (pfSense) + Local Certificate</h2>
<h3 id="use-case">Use Case</h3>
<p>Perfect for: - Internal homelab access only - No public domain
desired - Offline or air-gapped environments - Development and
testing</p>
<h3 id="step-1-split-dns-configuration-in-pfsense">Step 1: Split-DNS
Configuration in pfSense</h3>
<h4 id="configure-dns-resolver-host-overrides">Configure DNS Resolver
Host Overrides</h4>
<ol type="1">
<li>Login to pfSense web interface</li>
<li>Navigate to <strong>Services</strong> → <strong>DNS
Resolver</strong></li>
<li>Ensure DNS Resolver is <strong>enabled</strong></li>
<li>Scroll to <strong>Host Overrides</strong></li>
<li>Click <strong>“Add”</strong>:
<ul>
<li><strong>Host</strong>: <code>n8n</code></li>
<li><strong>Domain</strong>: <code>local.home</code> (or your
choice)</li>
<li><strong>IP Address</strong>: IP of host running NPM</li>
<li><strong>Description</strong>: n8n automation platform</li>
</ul></li>
<li>Click <strong>Save</strong> → <strong>Apply Changes</strong></li>
</ol>
<h4 id="test-dns-resolution">Test DNS Resolution</h4>
<p>From a client on your network:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Should resolve to your NPM host IP</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nslookup</span> n8n.local.home</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using dig</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">dig</span> n8n.local.home</span></code></pre></div>
<h3 id="step-2-generate-local-ssl-certificate">Step 2: Generate Local
SSL Certificate</h3>
<h4 id="option-a-self-signed-certificate-openssl">Option A: Self-Signed
Certificate (OpenSSL)</h4>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate private key</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> genrsa <span class="at">-out</span> n8n-local.key 2048</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate certificate signing request</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> req <span class="at">-new</span> <span class="at">-key</span> n8n-local.key <span class="at">-out</span> n8n-local.csr <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-subj</span> <span class="st">&quot;/C=US/ST=State/L=City/O=Homelab/CN=n8n.local.home&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate self-signed certificate</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> x509 <span class="at">-req</span> <span class="at">-days</span> 365 <span class="at">-in</span> n8n-local.csr <span class="dt">\</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">-signkey</span> n8n-local.key <span class="at">-out</span> n8n-local.crt</span></code></pre></div>
<h4 id="option-b-mkcert-recommended">Option B: mkcert (Recommended)</h4>
<p><strong>Why mkcert?</strong> Automatically trusted by browsers after
CA installation.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install mkcert</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On Ubuntu/Debian:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install libnss3-tools</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/FiloSottile/mkcert/releases/download/v1.4.4/mkcert-v1.4.4-linux-amd64</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> mv mkcert-v1.4.4-linux-amd64 /usr/local/bin/mkcert</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> chmod +x /usr/local/bin/mkcert</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Install local CA</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="ex">mkcert</span> <span class="at">-install</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate certificate for n8n</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="ex">mkcert</span> n8n.local.home <span class="st">&quot;*.local.home&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># n8n.local.home+1.pem (certificate)</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># n8n.local.home+1-key.pem (private key)</span></span></code></pre></div>
<h3 id="step-3-import-certificate-into-npm">Step 3: Import Certificate
into NPM</h3>
<ol type="1">
<li>In Nginx Proxy Manager, go to <strong>SSL Certificates</strong></li>
<li>Click <strong>“Add SSL Certificate”</strong> →
<strong>“Custom”</strong></li>
<li>Upload files:
<ul>
<li><strong>Certificate Key</strong>:
<code>n8n.local.home+1-key.pem</code></li>
<li><strong>Certificate</strong>: <code>n8n.local.home+1.pem</code></li>
</ul></li>
<li>Click <strong>Save</strong></li>
</ol>
<h3 id="step-4-create-proxy-host">Step 4: Create Proxy Host</h3>
<ol type="1">
<li>Click <strong>“Proxy Hosts”</strong> → <strong>“Add Proxy
Host”</strong></li>
<li><strong>Details Tab</strong>:
<ul>
<li><strong>Domain Names</strong>: <code>n8n.local.home</code></li>
<li><strong>Scheme</strong>: <code>http</code></li>
<li><strong>Forward Hostname/IP</strong>: <code>n8n</code> or container
IP</li>
<li><strong>Forward Port</strong>: <code>5678</code></li>
<li><strong>Websockets Support</strong>: ✓</li>
<li><strong>Block Common Exploits</strong>: ✓</li>
</ul></li>
<li><strong>SSL Tab</strong>:
<ul>
<li><strong>SSL Certificate</strong>: Select your custom
certificate</li>
<li><strong>Force SSL</strong>: ✓</li>
<li><strong>HTTP/2 Support</strong>: ✓</li>
</ul></li>
<li>Click <strong>Save</strong></li>
</ol>
<h3 id="step-5-install-ca-on-client-devices">Step 5: Install CA on
Client Devices</h3>
<h4 id="for-mkcert">For mkcert:</h4>
<p><strong>Linux:</strong></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mkcert</span> <span class="at">-install</span></span></code></pre></div>
<p><strong>Windows:</strong></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode powershell"><code class="sourceCode powershell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run mkcert installer</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mkcert-v1<span class="op">.</span><span class="dv">4.4</span><span class="op">-</span>windows-amd64<span class="op">.</span><span class="fu">exe</span> <span class="op">-</span>install</span></code></pre></div>
<p><strong>macOS:</strong></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">mkcert</span> <span class="at">-install</span></span></code></pre></div>
<p><strong>Mobile Devices:</strong> - Export CA certificate from
<code>mkcert -CAROOT</code> - Transfer to device - Install as trusted
certificate</p>
<h3 id="advantages-and-limitations-1">Advantages and Limitations</h3>
<p><strong>✅ Advantages:</strong> - No external dependencies - Works
offline - Full control over certificates - No public exposure</p>
<p><strong>⚠️ Limitations:</strong> - Requires CA installation on all
client devices - Manual certificate renewal - Only accessible on local
network</p>
<h2 id="troubleshooting-common-issues">Troubleshooting Common
Issues</h2>
<h3 id="issue-1-n8n-secure-cookie-error">Issue 1: n8n “Secure Cookie”
Error</h3>
<p><strong>Problem</strong>: n8n requires HTTPS for secure cookies</p>
<p><strong>Solutions</strong>:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: Use HTTPS (recommended)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Follow steps above</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Disable secure cookie (</span><span class="al">TESTING</span><span class="co"> ONLY)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">-e</span> N8N_SECURE_COOKIE=false n8nio/n8n</span></code></pre></div>
<h3 id="issue-2-npm-cannot-resolve-container-name">Issue 2: NPM Cannot
Resolve Container Name</h3>
<p><strong>Problem</strong>: Nginx Proxy Manager can’t reach n8n
container</p>
<p><strong>Solutions</strong>:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: Use Docker network</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure both containers are on same Docker network</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Use host IP instead of container name</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># In NPM proxy host, use: 192.168.x.x instead of &quot;n8n&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 3: Use Docker bridge IP</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> inspect n8n <span class="kw">|</span> <span class="fu">grep</span> IPAddress</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Use that IP in NPM configuration</span></span></code></pre></div>
<h3 id="issue-3-internal-dns-not-resolving">Issue 3: Internal DNS Not
Resolving</h3>
<p><strong>Problem</strong>: Clients can’t resolve
<code>n8n.local.home</code></p>
<p><strong>Solutions</strong>:</p>
<ol type="1">
<li><p><strong>Verify pfSense DNS Resolver is running</strong>:</p>
<ul>
<li>Services → DNS Resolver → Status</li>
</ul></li>
<li><p><strong>Check client DNS settings</strong>:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linux/macOS</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span> /etc/resolv.conf</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Should show pfSense IP</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="ex">ipconfig</span> /all</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check DNS Servers</span></span></code></pre></div></li>
<li><p><strong>Test from pfSense itself</strong>:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics → Command Prompt</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nslookup</span> n8n.local.home</span></code></pre></div></li>
</ol>
<h3 id="issue-4-lets-encrypt-dns-01-challenge-fails">Issue 4: Let’s
Encrypt DNS-01 Challenge Fails</h3>
<p><strong>Problem</strong>: Certificate request fails</p>
<p><strong>Solutions</strong>:</p>
<ol type="1">
<li><p><strong>Verify API Token Permissions</strong>:</p>
<ul>
<li>Must have <strong>Zone:DNS:Edit</strong> for specific zone</li>
<li>Cannot use global API key</li>
</ul></li>
<li><p><strong>Check TXT Record Propagation</strong>:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">dig</span> _acme-challenge.n8n.my-portfolio.tk TXT</span></code></pre></div></li>
<li><p><strong>Review NPM Logs</strong>:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> logs nginx-proxy-manager</span></code></pre></div></li>
</ol>
<h2 id="security-best-practices">Security Best Practices</h2>
<h3 id="enable-authentication-in-n8n">1. Enable Authentication in
n8n</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># docker-compose.yml</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_ACTIVE=true</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_USER=admin</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_PASSWORD=secure_password_here</span></span></code></pre></div>
<h3 id="restrict-access-by-ip">2. Restrict Access by IP</h3>
<p>In NPM, add Access List: - <strong>Allow</strong>: Your trusted IPs -
<strong>Deny</strong>: All others</p>
<h3 id="use-strong-cloudflare-settings">3. Use Strong Cloudflare
Settings</h3>
<ul>
<li>Enable <strong>Bot Fight Mode</strong></li>
<li>Add <strong>Page Rules</strong> for rate limiting</li>
<li>Enable <strong>Always Use HTTPS</strong></li>
</ul>
<h3 id="monitor-access-logs">4. Monitor Access Logs</h3>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View NPM access logs</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> exec <span class="at">-it</span> nginx-proxy-manager tail <span class="at">-f</span> /data/logs/proxy-host-<span class="pp">*</span>.log</span></code></pre></div>
<h3 id="regular-certificate-monitoring">5. Regular Certificate
Monitoring</h3>
<ul>
<li>Set calendar reminder for certificate expiry</li>
<li>Monitor NPM renewal logs</li>
<li>Test access after renewals</li>
</ul>
<h2 id="validation-checklist">Validation Checklist</h2>
<h3 id="for-public-domain-setup">For Public Domain Setup:</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Domain registered and
active</label></li>
<li><label><input type="checkbox" />Cloudflare nameservers
configured</label></li>
<li><label><input type="checkbox" />API token created with correct
permissions</label></li>
<li><label><input type="checkbox" />DNS record pointing to public
IP</label></li>
<li><label><input type="checkbox" />NPM proxy host created with
Websocket support</label></li>
<li><label><input type="checkbox" />Let’s Encrypt certificate issued
successfully</label></li>
<li><label><input type="checkbox" />HTTPS access working from external
network</label></li>
<li><label><input type="checkbox" />n8n workflows execute
correctly</label></li>
</ul>
<h3 id="for-local-setup">For Local Setup:</h3>
<ul class="task-list">
<li><label><input type="checkbox" />pfSense DNS Resolver
enabled</label></li>
<li><label><input type="checkbox" />Host Override configured for
<code>n8n.local.home</code></label></li>
<li><label><input type="checkbox" />Local certificate generated (mkcert
or OpenSSL)</label></li>
<li><label><input type="checkbox" />Certificate imported into
NPM</label></li>
<li><label><input type="checkbox" />NPM proxy host created with custom
SSL</label></li>
<li><label><input type="checkbox" />CA installed on client
devices</label></li>
<li><label><input type="checkbox" />HTTPS access working from
LAN</label></li>
<li><label><input type="checkbox" />No browser certificate
warnings</label></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Securing n8n with proper DNS and TLS configuration transforms a
vulnerable automation platform into a production-ready system. Whether
you choose the public domain approach with Let’s Encrypt or the local
certificate method, both provide strong encryption and professional
access management.</p>
<p>The key is understanding your requirements: - <strong>Public access
needed?</strong> → Option A (Cloudflare + Let’s Encrypt) -
<strong>Internal only?</strong> → Option B (pfSense + Local Certs)</p>
<p>Both approaches demonstrate infrastructure maturity and security
awareness, critical skills for any homelab administrator or security
professional.</p>
<p><em>Remember: Security is layers. DNS and TLS are just the beginning
- add authentication, monitoring, and regular audits for comprehensive
protection.</em></p>
                </div>

                <div class="article-navigation">
                </div>
            </div>
        </section>
    </main>

    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>OLYAHYAI</h3>
                    <p>Pentester in Training | Cybersecurity Enthusiast</p>
                </div>

                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="/index.html#home">Home</a></li>
                        <li><a href="/index.html#about">About</a></li>
                        <li><a href="/index.html#projects">Projects</a></li>
                        <li><a href="/blog/index.html">Blog</a></li>
                    </ul>
                </div>

                <div class="footer-social">
                    <h4>Connect</h4>
                    <div class="social-links">
                        <a href="https://github.com/OLYAHYAI" target="_blank" rel="noopener">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://ma.linkedin.com/in/lyahyai-omar" target="_blank" rel="noopener">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="mailto:contact@olyahyai.com">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 OLYAHYAI. All rights reserved.</p>
                <p>Built with <i class="fas fa-heart"></i> and <i class="fas fa-terminal"></i></p>
            </div>
        </div>
    </footer>

    <button class="back-to-top" aria-label="Back to top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/animations.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>