<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sécurisation de mes flux de travail n8n : Plongée dans le DNS et le TLS - Tutoriel et guide technique">
    <meta name="keywords" content="n8n">
    <meta name="author" content="Omar LYAHYAI">

    <title>Sécurisation de mes flux de travail n8n : Plongée dans le DNS et le TLS | Blog Technique d'Omar LYAHYAI</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/blog.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="dark-theme">
    <a href="#main-content" class="skip-link">Passer au contenu principal</a>

    <header class="header" role="banner">
        <nav class="navbar" role="navigation" aria-label="Main navigation">
            <div class="container">
                <div class="nav-brand">
                    <a href="/index.html" class="logo">
                        <i class="fas fa-terminal"></i>
                        <span>OLYAHYAI</span>
                    </a>
                </div>

                <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>

                <ul class="nav-menu">
                    <li><a href="/index.html#home" class="nav-link">Accueil</a></li>
                    <li><a href="/index.html#about" class="nav-link">À Propos</a></li>
                    <li><a href="/index.html#projects" class="nav-link">Projets</a></li>
                    <li><a href="/index.html#skills" class="nav-link">Compétences</a></li>
                    <li><a href="/blog/index.html" class="nav-link active">Blog</a></li>
                    <li><a href="/index.html#contact" class="nav-link">Contact</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="/fr/network_security/securing-n8n-workflows-deep-dive-dns-tls.html" class="lang-toggle" aria-label="Changer de langue">
                        <span class="lang-current">FR</span>
                        <i class="fas fa-globe"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section class="article-header" role="region" aria-label="Article header">
            <div class="container">
                <div class="article-breadcrumb">
                    <nav class="breadcrumb" aria-label="Breadcrumb">
                        <a href="/index.html">Accueil</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/index.html">Blog</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/network_security.html">Sécurité Réseau</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <span>Sécurisation de mes flux de travail n8n : Plongée dans le DNS et le TLS</span>
                    </nav>
                </div>

                <h1 class="article-title">Sécurisation de mes flux de travail n8n : Plongée dans le DNS et le TLS</h1>

                <div class="article-meta">
                    <div class="article-meta-item">
                        <i class="far fa-calendar"></i>
                        <span>2025-10-25</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="far fa-clock"></i>
                        <span>8 min de lecture</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-folder"></i>
                        <span>Sécurité Réseau</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-tags"></i>
                        <span>n8n</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="article-content" role="region" aria-label="Article content">
            <div class="container">
                <div class="article-body">
                    <h1 id="securing-my-n8n-workflows-a-deep-dive-into-dns-and-tls">Sécurisation
de mes flux de travail n8n : Plongée dans le DNS et le TLS</h1>
<h2 id="objective">Objectif</h2>
<p>Établir un accès <strong>fiable et chiffré</strong> à n8n (et aux
services associés) que ce soit <strong>publiquement</strong> (via le
challenge DNS-01 de Let’s Encrypt) ou <strong>sur le LAN</strong> (via
Split-DNS + certificat local).</p>
<h2 id="why-secure-n8n">Pourquoi Sécuriser n8n ?</h2>
<p>n8n est une puissante plateforme d'automatisation qui gère souvent des
identifiants sensibles, des clés API et des flux de travail critiques
pour l'entreprise. Sécuriser l'accès avec un DNS et un TLS appropriés
garantit :</p>
<ul>
<li><strong>Protection des données</strong> : Les connexions chiffrées
empêchent l'interception des identifiants</li>
<li><strong>Authentification</strong> : Les certificats vérifiés
préviennent les attaques de l'homme du milieu</li>
<li><strong>Conformité</strong> : Respect des meilleures pratiques de
sécurité pour l'automatisation des flux de travail</li>
<li><strong>Configuration professionnelle</strong> : Démontre la maturité
de l'infrastructure</li>
</ul>
<h2 id="architecture-overview">Aperçu de l'Architecture</h2>
<pre><code>Internet/LAN Clients
       ↓
   pfSense (DNS + Firewall)
       ↓
Nginx Proxy Manager (TLS Termination)
       ↓
   n8n Docker Container (5678)</code></pre>
<h2
id="option-a-public-domain-cloudflare-dns-challenge-lets-encrypt">Option
A : Domaine Public + Cloudflare + Challenge DNS (Let’s Encrypt)</h2>
<h3 id="prerequisites">Prérequis</h3>
<ul>
<li>Domaine public (des services gratuits comme Freenom peuvent être
utilisés)</li>
<li>Compte Cloudflare (le niveau gratuit est suffisant)</li>
<li>Nginx Proxy Manager déployé</li>
<li>n8n fonctionnant dans Docker</li>
</ul>
<h3 id="step-1-domain-setup-with-cloudflare">Étape 1 : Configuration du
Domaine avec Cloudflare</h3>
<h4 id="register-free-domain-optional">Enregistrer un Domaine Gratuit
(Optionnel)</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visit Freenom.com</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Register domain: my-portfolio.tk (or similar)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Free domains may have limitations</span></span></code></pre></div>
<h4 id="add-domain-to-cloudflare">Ajouter le Domaine à Cloudflare</h4>
<ol type="1">
<li>Créer un compte Cloudflare sur cloudflare.com</li>
<li>Cliquer sur <strong>« Ajouter un site »</strong></li>
<li>Saisir votre nom de domaine</li>
<li>Choisir le <strong>plan Gratuit</strong></li>
<li>Copier les serveurs de noms Cloudflare</li>
</ol>
<h4 id="update-nameservers-at-registrar">Mettre à Jour les Serveurs de
Noms chez le Registraire</h4>
<ol type="1">
<li><p>Se connecter à votre registraire de domaine (Freenom, Namecheap,
etc.)</p></li>
<li><p>Naviguer vers <strong>Gestion DNS</strong></p></li>
<li><p>Remplacer les serveurs de noms existants par ceux de
Cloudflare :</p>
<pre><code>ns1.cloudflare.com
ns2.cloudflare.com</code></pre></li>
<li><p>Attendre la propagation (cela peut prendre jusqu'à 24 heures)</p></li>
</ol>
<h3 id="step-2-generate-cloudflare-api-token">Étape 2 : Générer un Jeton
API Cloudflare</h3>
<ol type="1">
<li>Dans le tableau de bord Cloudflare, cliquer sur l'icône de profil</li>
<li>Naviguer vers <strong>« Mon Profil »</strong> → <strong>« Jetons
API »</strong></li>
<li>Cliquer sur <strong>« Créer un Jeton »</strong></li>
<li>Utiliser le modèle : <strong>« Modifier le DNS de zone »</strong></li>
<li>Configurer les permissions :
<ul>
<li><strong>Zone</strong> : Modification DNS</li>
<li><strong>Inclure</strong> : Zone spécifique (votre domaine)</li>
</ul></li>
<li>Cliquer sur <strong>« Continuer vers le résumé »</strong> →
<strong>« Créer un Jeton »</strong></li>
<li><strong>Sauvegarder ce jeton en lieu sûr</strong> - vous ne le
verrez qu'une seule fois !</li>
</ol>
<h3 id="step-3-configure-nginx-proxy-manager">Étape 3 : Configurer Nginx
Proxy Manager</h3>
<h4 id="create-dns-record-in-cloudflare">Créer l'Enregistrement DNS dans
Cloudflare</h4>
<ol type="1">
<li>Dans Cloudflare, aller à l'onglet <strong>DNS</strong></li>
<li>Ajouter un enregistrement A :
<ul>
<li><strong>Type</strong> : A</li>
<li><strong>Name</strong> : <code>n8n</code> (ou <code>@</code> pour le
domaine racine)</li>
<li><strong>Adresse IPv4</strong> : Votre IP publique ou utiliser le
proxy Cloudflare</li>
<li><strong>Statut du Proxy</strong> : ✓ Proxifié (nuage orange)</li>
</ul></li>
</ol>
<h4 id="add-proxy-host-in-npm">Ajouter un Hôte Proxy dans NPM</h4>
<ol type="1">
<li>Accéder à Nginx Proxy Manager :
<code>http://&lt;npm-ip&gt;:81</code></li>
<li>Cliquer sur <strong>« Hôtes Proxy »</strong> → <strong>« Ajouter un
Hôte Proxy »</strong></li>
<li><strong>Onglet Détails</strong> :
<ul>
<li><strong>Noms de Domaine</strong> : <code>n8n.my-portfolio.tk</code></li>
<li><strong>Schéma</strong> : <code>http</code></li>
<li><strong>Nom d'hôte/IP de Transfert</strong> : <code>n8n</code> (nom
du conteneur Docker) ou IP</li>
<li><strong>Port de Transfert</strong> : <code>5678</code></li>
<li><strong>Support Websockets</strong> : ✓ <strong>CRITIQUE pour
n8n</strong></li>
<li><strong>Bloquer les Exploits Courants</strong> : ✓</li>
</ul></li>
<li><strong>Onglet SSL</strong> :
<ul>
<li><p>Sélectionner <strong>« Demander un nouveau Certificat
SSL »</strong></p></li>
<li><p>Activer <strong>« Utiliser un Challenge DNS »</strong></p></li>
<li><p><strong>Fournisseur DNS</strong> : Sélectionner
<strong>Cloudflare</strong></p></li>
<li><p><strong>Contenu du Fichier d'Identifiants</strong> :</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="dt">dns_cloudflare_api_token </span><span class="ot">=</span><span class="st"> YOUR_CLOUDFLARE_API_TOKEN</span></span></code></pre></div></li>
<li><p><strong>Adresse Email</strong> : Votre email pour Let’s
Encrypt</p></li>
<li><p>Options :</p>
<ul>
<li>✓ Forcer SSL</li>
<li>✓ Support HTTP/2</li>
<li>✓ HSTS Activé</li>
</ul></li>
</ul></li>
<li>Cliquer sur <strong>Sauvegarder</strong></li>
</ol>
<h3 id="step-4-verify-access">Étape 4 : Vérifier l'Accès</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test DNS resolution</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nslookup</span> n8n.my-portfolio.tk</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test HTTPS access</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-I</span> https://n8n.my-portfolio.tk</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Access in browser</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">https://n8n.my-portfolio.tk</span></span></code></pre></div>
<h3 id="advantages-and-limitations">Avantages et Limites</h3>
<p><strong>✅ Avantages :</strong> - Certificat SSL public valide -
Renouvellement automatique tous les 90 jours - Pas besoin d'ouvrir les
ports 80/443 pour la validation HTTP-01 - Fonctionne de n'importe où
avec accès à Internet</p>
<p><strong>⚠️ Limites :</strong> - Nécessite un domaine public et la
propagation DNS - Dépend de services externes (Cloudflare, Let’s Encrypt)
- Problèmes potentiels de confidentialité dus à l'exposition publique</p>
<h2 id="option-b-local-dns-pfsense-local-certificate">Option B : DNS
Local (pfSense) + Certificat Local</h2>
<h3 id="use-case">Cas d'Usage</h3>
<p>Parfait pour : - Accès interne homelab uniquement - Aucun domaine
public souhaité - Environnements hors ligne ou isolés (air-gapped) -
Développement et tests</p>
<h3 id="step-1-split-dns-configuration-in-pfsense">Étape 1 :
Configuration du Split-DNS dans pfSense</h3>
<h4 id="configure-dns-resolver-host-overrides">Configurer les Surcharges
d'Hôte du Résolveur DNS</h4>
<ol type="1">
<li>Se connecter à l'interface web de pfSense</li>
<li>Naviguer vers <strong>Services</strong> → <strong>DNS
Resolver</strong></li>
<li>S'assurer que le Résolveur DNS est <strong>activé</strong></li>
<li>Défiler jusqu'à <strong>Host Overrides</strong> (Surcharges
d'hôte)</li>
<li>Cliquer sur <strong>« Ajouter »</strong> :
<ul>
<li><strong>Hôte</strong> : <code>n8n</code></li>
<li><strong>Domaine</strong> : <code>local.home</code> (ou votre
choix)</li>
<li><strong>Adresse IP</strong> : IP de l'hôte exécutant NPM</li>
<li><strong>Description</strong> : plateforme d'automatisation n8n</li>
</ul></li>
<li>Cliquer sur <strong>Sauvegarder</strong> → <strong>Appliquer les
Modifications</strong></li>
</ol>
<h4 id="test-dns-resolution">Tester la Résolution DNS</h4>
<p>Depuis un client sur votre réseau :</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Should resolve to your NPM host IP</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">nslookup</span> n8n.local.home</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Or using dig</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">dig</span> n8n.local.home</span></code></pre></div>
<h3 id="step-2-generate-local-ssl-certificate">Étape 2 : Générer un
Certificat SSL Local</h3>
<h4 id="option-a-self-signed-certificate-openssl">Option A : Certificat
Auto-Signé (OpenSSL)</h4>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate private key</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> genrsa <span class="at">-out</span> n8n-local.key 2048</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate certificate signing request</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> req <span class="at">-new</span> <span class="at">-key</span> n8n-local.key <span class="at">-out</span> n8n-local.csr <span class="dt">\</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-subj</span> <span class="st">&quot;/C=US/ST=State/L=City/O=Homelab/CN=n8n.local.home&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate self-signed certificate</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ex">openssl</span> x509 <span class="at">-req</span> <span class="at">-days</span> 365 <span class="at">-in</span> n8n-local.csr <span class="dt">\</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">-signkey</span> n8n-local.key <span class="at">-out</span> n8n-local.crt</span>