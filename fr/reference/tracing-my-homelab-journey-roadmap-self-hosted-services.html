<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Créez un homelab sécurisé avec Proxmox, pfSense et Ubuntu. Couvre la virtualisation, l'accès Zero-Trust (Twingate), l'automatisation des flux de travail (n8n) et les services auto-hébergés...">
    <meta name="keywords" content="homelab, proxmox, pfsense, twingate, automation, zero-trust, virtualization">
    <meta name="author" content="OLYAHYAI">

    <title>Traçage de mon parcours Homelab, Feuille de route des services auto-hébergés | Blog Technique d'Omar LYAHYAI</title>

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/responsive.css">
    <link rel="stylesheet" href="/css/animations.css">
    <link rel="stylesheet" href="/css/blog.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body class="dark-theme">
    <a href="#main-content" class="skip-link">Passer au contenu principal</a>

    <header class="header" role="banner">
        <nav class="navbar" role="navigation" aria-label="Navigation principale">
            <div class="container">
                <div class="nav-brand">
                    <a href="/index.html" class="logo">
                        <i class="fas fa-terminal"></i>
                        <span>OLYAHYAI</span>
                    </a>
                </div>

                <button class="nav-toggle" aria-label="Basculer la navigation" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>

                <ul class="nav-menu">
                    <li><a href="/index.html#home" class="nav-link">Accueil</a></li>
                    <li><a href="/index.html#about" class="nav-link">À propos</a></li>
                    <li><a href="/index.html#projects" class="nav-link">Projets</a></li>
                    <li><a href="/index.html#skills" class="nav-link">Compétences</a></li>
                    <li><a href="/blog/index.html" class="nav-link active">Blog</a></li>
                    <li><a href="/index.html#contact" class="nav-link">Contact</a></li>
                </ul>

                <div class="nav-actions">
                    <a href="/en/reference/tracing-my-homelab-journey-roadmap-self-hosted-services.html" class="lang-toggle" aria-label="Changer de langue">
                        <span class="lang-current">EN</span>
                        <i class="fas fa-globe"></i>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main id="main-content">
        <section class="article-header" role="region" aria-label="En-tête de l'article">
            <div class="container">
                <div class="article-breadcrumb">
                    <nav class="breadcrumb" aria-label="Fil d'Ariane">
                        <a href="/index.html">Accueil</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/index.html">Blog</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <a href="/blog/reference.html">Référence</a>
                        <span class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></span>
                        <span>Traçage de mon parcours Homelab, Feuille de route des services auto-hébergés</span>
                    </nav>
                </div>

                <h1 class="article-title">Traçage de mon parcours Homelab, Feuille de route des services auto-hébergés</h1>

                <div class="article-meta">
                    <div class="article-meta-item">
                        <i class="far fa-calendar"></i>
                        <span>2025-11-19</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="far fa-clock"></i>
                        <span>5 min de lecture</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-folder"></i>
                        <span>Référence</span>
                    </div>
                    <div class="article-meta-item">
                        <i class="fas fa-tags"></i>
                        <span>homelab, proxmox, pfsense, twingate, automation, zero-trust, virtualization</span>
                    </div>
                </div>
            </div>
        </section>

        <section class="article-content" role="region" aria-label="Contenu de l'article">
            <div class="container">
                <div class="article-body">
                    <!-- 
TEMPLATE - Press Alt+E to apply
UPDATE THESE FIELDS:
- title: "Your Title" (KEEP QUOTES)
- date: "YYYY-MM-DD" (KEEP QUOTES)
- category: infrastructure/network_security/automation_ai/reference
- language: auto (let workflow detect) | en (force English) | fr (force French)
- tags: single-keyword-only (NO COMMAS! Use one word or hyphenated)
- description: "Short summary" (KEEP QUOTES)

CRITICAL RULES:
✅ DO: Keep quotes around title, date, description
✅ DO: Use "auto" for language to let workflow detect from content
✅ DO: Use single word for tags (homelab, pfsense, proxmox)
❌ DON'T: Use commas in tags (breaks YAML!)
❌ DON'T: Remove quotes from title/date/description

The workflow will:
- Detect language automatically from your content
- Generate English + French versions
- Create full HTML with navigation
- Preserve images and links
-->
<h1 id="homelab-overview">Aperçu du Homelab</h1>
<p>Vous gérez votre homelab à l'aide de Proxmox avec des VMs pour Ubuntu,
Kali, et pfSense. Vos principaux objectifs incluent l'hébergement de vos propres services,
l'automatisation des flux de travail et la connexion sécurisée de l'ensemble avec
Twingate.</p>
<h2 id="infrastructure-components">Composants de l'infrastructure</h2>
<h3 id="proxmox-ve-hypervisor">Proxmox VE (Hyperviseur)</h3>
<ul>
<li><strong>Objectif</strong>: Plateforme de virtualisation pour tous les
services</li>
<li><strong>Matériel</strong>: Serveur dédié ou station de travail
puissante</li>
<li><strong>VMs hébergées</strong>:
<ul>
<li>Ubuntu Server (services principaux)</li>
<li>Kali Linux (tests d'intrusion)</li>
<li>pfSense (pare-feu et routage)</li>
</ul></li>
</ul>
<h3 id="ubuntu-vm-services-host">VM Ubuntu (Hôte de services)</h3>
<ul>
<li><strong>Rôle</strong>: Serveur d'applications principal</li>
<li><strong>Services</strong>:
<ul>
<li>Synchronisation Obsidian (CouchDB)</li>
<li>Plateforme d'automatisation n8n</li>
<li>Conteneurs Docker</li>
<li>Serveurs de bases de données</li>
</ul></li>
</ul>
<h3 id="pfsense-vm-network-security">VM pfSense (Sécurité réseau)</h3>
<ul>
<li><strong>Rôle</strong>: Pare-feu et passerelle réseau</li>
<li><strong>Fonctionnalités</strong>:
<ul>
<li>Gestion des VLANs</li>
<li>Serveur VPN</li>
<li>Résolveur DNS</li>
<li>Surveillance du trafic</li>
</ul></li>
</ul>
<h3 id="twingate-secure-remote-access">Twingate (Accès distant
sécurisé)</h3>
<ul>
<li><strong>Objectif</strong>: Accès réseau Zero-Trust</li>
<li><strong>Avantages</strong>: Accès distant sécurisé sans exposition des
ports</li>
</ul>
<h2 id="obsidian-setup">Configuration d'Obsidian</h2>
<h3 id="self-hosted-sync-solution">Solution de synchronisation
auto-hébergée</h3>
<ul>
<li>Obsidian est auto-hébergé à l'aide de CouchDB</li>
<li>Exécuté sur la VM Ubuntu</li>
<li>Connecté à l'aide du plugin <strong>Obsidian LiveSync</strong></li>
<li>Accès distant sécurisé géré via <strong>Twingate</strong></li>
</ul>
<h3 id="why-self-host-obsidian-sync">Pourquoi auto-héberger la
synchronisation Obsidian ?</h3>
<ol type="1">
<li><strong>Souveraineté des données</strong>: Contrôle total sur vos notes</li>
<li><strong>Confidentialité</strong>: Aucun accès tiers aux informations sensibles</li>
<li><strong>Coût</strong>: Alternative gratuite à l'abonnement Obsidian Sync</li>
<li><strong>Apprentissage</strong>: Expérience pratique de la gestion de bases de données</li>
</ol>
<h2 id="step-by-step-setup-plan">Plan de configuration étape par étape</h2>
<h3 id="phase-1-server-preparation">Phase 1 : Préparation du serveur</h3>
<h4 id="update-and-secure-ubuntu-vm">1. Mettre à jour et sécuriser la VM Ubuntu</h4>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mises à jour système</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt update <span class="kw">&amp;&amp;</span> <span class="fu">sudo</span> apt upgrade <span class="at">-y</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer les outils essentiels</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install <span class="at">-y</span> curl wget git vim ufw</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer le pare-feu</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw default deny incoming</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw default allow outgoing</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw allow ssh</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> ufw enable</span></code></pre></div>
<h4 id="install-docker-and-docker-compose">2. Installer Docker et Docker
Compose</h4>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer Docker</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-fsSL</span> https://get.docker.com <span class="at">-o</span> get-docker.sh</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> sh get-docker.sh</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer Docker Compose</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> apt install docker-compose <span class="at">-y</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter l'utilisateur au groupe docker</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> usermod <span class="at">-aG</span> docker <span class="va">$USER</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="ex">newgrp</span> docker</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier l'installation</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> <span class="at">--version</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> <span class="at">--version</span></span></code></pre></div>
<h4 id="create-service-directories">3. Créer les répertoires de services</h4>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer une structure de répertoires organisée</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> ~/services/<span class="dt">{obsidian-sync</span><span class="op">,</span><span class="dt">n8n</span><span class="op">,</span><span class="dt">backups}</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/services</span></code></pre></div>
<h3 id="phase-2-deploy-couchdb-for-obsidian-sync">Phase 2 : Déploiement
de CouchDB pour la synchronisation Obsidian</h3>
<h4 id="create-docker-compose-configuration">1. Créer la configuration
Docker Compose</h4>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/services/obsidian-sync</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> docker-compose.yml</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3.8&#39;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">couchdb</span><span class="kw">:</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> couchdb:latest</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">container_name</span><span class="kw">:</span><span class="at"> couchdb-for-obsidian</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> COUCHDB_USER=admin</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> COUCHDB_PASSWORD=your_secure_password_here</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./data:/opt/couchdb/data</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./config:/opt/couchdb/etc/local.d</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> 5984:5984</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> homelab</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">homelab</span><span class="kw">:</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at"> bridge</span></span></code></pre></div>
<h4 id="launch-couchdb">2. Lancer CouchDB</h4>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Démarrer CouchDB</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">-d</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier son exécution</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> ps <span class="kw">|</span> <span class="fu">grep</span> couchdb</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier les logs</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> logs <span class="at">-f</span> couchdb-for-obsidian</span></code></pre></div>
<h4 id="configure-couchdb">3. Configurer CouchDB</h4>
<ol type="1">
<li>Ouvrir le tableau de bord CouchDB :
<code>http://&lt;ubuntu-vm-ip&gt;:5984/_utils</code></li>
<li>Se connecter avec les identifiants de docker-compose.yml</li>
<li>Créer une base de données nommée <strong>obsidian</strong></li>
<li>Activer CORS si l'accès provient d'origines différentes</li>
</ol>
<h4 id="connect-obsidian-desktop">4. Connecter le client de bureau Obsidian</h4>
<ol type="1">
<li>Installer le plugin <strong>Self-Hosted LiveSync</strong> dans
Obsidian</li>
<li>Configurer les paramètres du plugin :
<ul>
<li><strong>URL de la base de données distante</strong>:
<code>http://&lt;ubuntu-vm-ip&gt;:5984/obsidian</code></li>
<li><strong>Nom d'utilisateur</strong>: <code>admin</code></li>
<li><strong>Mot de passe</strong>: Votre mot de passe CouchDB</li>
</ul></li>
<li>Initialiser la synchronisation et tester</li>
</ol>
<h3 id="phase-3-install-and-configure-n8n">Phase 3 : Installer et
configurer n8n</h3>
<h4 id="create-n8n-directory-and-configuration">1. Créer le répertoire et la configuration n8n</h4>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> ~/services/n8n</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> docker-compose.yml</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;3&#39;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">n8n</span><span class="kw">:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">image</span><span class="kw">:</span><span class="at"> n8nio/n8n:latest</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">container_name</span><span class="kw">:</span><span class="at"> n8n-automation</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">restart</span><span class="kw">:</span><span class="at"> unless-stopped</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">environment</span><span class="kw">:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> GENERIC_TIMEZONE=Europe/Paris</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_ACTIVE=true</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_USER=admin</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_BASIC_AUTH_PASSWORD=secure_password</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_HOST=n8n.lab</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_PORT=5678</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> N8N_PROTOCOL=https</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> WEBHOOK_URL=https://n8n.lab/</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">ports</span><span class="kw">:</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> 5678:5678</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">volumes</span><span class="kw">:</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./data:/home/node/.n8n</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> ./local-files:/files</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> homelab</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">networks</span><span class="kw">:</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">homelab</span><span class="kw">:</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">external</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<h4 id="launch-n8n">2. Lancer n8n</h4>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Démarrer n8n</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">docker-compose</span> up <span class="at">-d</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier l'état</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="ex">docker</span> logs <span class="at">-f</span> n8n-automation</span></code></pre></div>
<h4 id="access-n8n-interface">3. Accéder à l'interface n8n</h4>
<ul>
<li>Naviguer vers : <code>http://&lt;ubuntu-vm-ip&gt;:5678</code></li>
<li>Se connecter avec les identifiants de docker-compose.yml</li>
<li>Compléter l'assistant de configuration initial</li>
</ul>
<h3 id="phase-4-automate-backups-with-n8n">Phase 4 : Automatiser les
sauvegardes avec n8n</h3>
<h4 id="backup-strategy">Stratégie de sauvegarde</h4>
<ol type="1">
<li><strong>Sauvegardes quotidiennes</strong>: Coffre Obsidian et données CouchDB</li>
<li><strong>Sauvegardes hebdomadaires</strong>: Configuration complète du système</li>
<li><strong>Archives mensuelles</strong>: Stockage à long terme</li>
</ol>
<h4 id="create-backup-workflow-in-n8n">Créer un flux de travail de
sauvegarde dans n8n</h4>
<h5 id="workflow-components">Composants du flux de travail :</h5>
<ol type="1">
<li><p><strong>Déclencheur planifié</strong> (Nœud Cron)</p>
<ul>
<li><strong>Planification</strong>: Tous les dimanches à 2h00</li>
<li><strong>Expression</strong>: <code>0 2 * * 0</code></li>
</ul></li>
<li><p><strong>Créer une sauvegarde</strong> (Nœud d'exécution de commande)</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="va">BACKUP_DIR</span><span class="op">=</span><span class="st">&quot;/backups/obsidian&quot;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="va">DATE</span><span class="op">=</span><span class="va">$(</span><span class="fu">date</span> +%Y-%m-%d_%H-%M-%S<span class="va">)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer le répertoire de sauvegarde</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> <span class="at">-p</span> <span class="va">$BACKUP_DIR</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarder le coffre Obsidian</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> czf <span class="va">$BACKUP_DIR</span>/obsidian-vault_<span class="va">$DATE</span>.tar.gz /path/to/obsidian-vault</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarder les données CouchDB</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tar</span> czf <span class="va">$BACKUP_DIR</span>/couchdb-data_<span class="va">$DATE</span>.tar.gz ~/services/obsidian-sync/data</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver uniquement les sauvegardes des 4 dernières semaines</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">find</span> <span class="va">$BACKUP_DIR</span> <span class="at">-name</span> <span class="st">&quot;*.tar.gz&quot;</span> <span class="at">-mtime</span> +28 <span class="at">-delete</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;Sauvegarde terminée : </span><span class="va">$DATE</span><span class="st">&quot;</span></span></code></pre></div></li>
<li><p><strong>Vérifier la sauvegarde</strong> (Nœud d'exécution de commande)</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier si le fichier de sauvegarde existe et a une taille raisonnable</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="va">LATEST_BACKUP</span><span class="op">=</span><span class="va">$(</span><span class="fu">ls</span> <span class="at">-t</span> /backups/obsidian/<span class="pp">*</span>.tar.gz <span class="kw">|</span> <span class="fu">head</span> <span class="at">-1</span><span class="va">)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="va">SIZE</span><span class="op">=</span><span class="va">$(</span><span class="fu">stat</span> <span class="at">-f%z</span> <span class="st">&quot;</span><span class="va">$LATEST_BACKUP</span><span class="st">&quot;</span> <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="fu">stat</span> <span class="at">-c%s</span> <span class="st">&quot;</span><span class="va">$LATEST_BACKUP</span><span class="st">&quot;</span><span class="va">)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="va">$SIZE</span> <span class="ot">-gt</span> 1024 <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Sauvegarde réussie : </span><span class="va">$LATEST_BACKUP</span><span class="st"> (</span><span class="va">$SIZE</span><span class="st"> bytes)&quot;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 0</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Sauvegarde échouée ou trop petite !&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span></code></pre></div></li>
<li><p><strong>Envoyer une notification</strong> (Nœud Requête HTTP ou
Telegram)</p>
<ul>
<li>Sur succès : “✅ Sauvegarde terminée avec succès”</li>
<li>Sur échec : “❌ Sauvegarde échouée ! Veuillez vérifier les logs”</li>
</ul></li>
</ol>
<h3 id="phase-5-remote-access-and-security">Phase 5 : Accès distant et
sécurité</h3>
<h4 id="install-twingate">Installer Twingate</h4>
<ol type="1">
<li><strong>Créer un compte Twingate</strong>
<ul>
<li>S'inscrire sur <a href="https://www.twingate.com">twingate.com</a></li>
<li>Créer un nouveau réseau</li>
</ul></li>
<li><strong>Déployer le connecteur Twingate</strong></li>
</ol>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Télécharger et installer le connecteur Twingate</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> https://binaries.twingate.com/connector/setup.sh <span class="kw">|</span> <span class="fu">sudo</span> bash</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer le connecteur</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> twingate-connector setup</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Configurer les ressources</strong>
<ul>
<li>Ajouter les services de la VM Ubuntu</li>
<li>Ajouter l'interface web Proxmox</li>
<li>Ajouter la plateforme d'automatisation n8n</li>
</ul></li>
</ol>
<h4 id="alternative-cloudflare-tunnel">Alternative : Tunnel Cloudflare</h4>
<p>Pour un accès HTTPS sans redirection de port :</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer cloudflared</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wget</span> https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-linux-amd64.deb</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sudo</span> dpkg <span class="at">-i</span> cloudflared-linux-amd64.deb</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Authentification</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel login</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un tunnel</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="ex">cloudflared</span> tunnel create homelab</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurer le tunnel</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">nano</span> ~/.cloudflared/config.yml</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tunnel</span><span class="kw">:</span><span class="at"> &lt;tunnel-id&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">credentials-file</span><span class="kw">:</span><span class="at"> /root/.cloudflared/&lt;tunnel-id&gt;.json</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ingress</span><span class="kw">:</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> n8n.yourdomain.com</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> http://localhost:5678</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">hostname</span><span class="kw">:</span><span class="at"> couchdb.yourdomain.com</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">service</span><span class="kw">:</span><span class="at"> http://localhost:5984</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> http_status:404</span></span></code></pre></div>
<h2 id="weekend-action-plan">Plan d'action pour le week-end</h2>
<h3 id="saturday-schedule">Programme du samedi</h3>
<h4 id="morning-2-3-hours">Matin (2-3 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Maintenance et mises à jour
Proxmox</label></li>
<li><label><input type="checkbox" />Mises à jour système de la VM
Ubuntu</label></li>
<li><label><input type="checkbox" />Installer Docker et Docker
Compose</label></li>
<li><label><input type="checkbox" />Créer les répertoires de
services</label></li>
</ul>
<h4 id="afternoon-2-3-hours">Après-midi (2-3 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Déployer le conteneur
CouchDB</label></li>
<li><label><input type="checkbox" />Configurer la base de données
CouchDB</label></li>
<li><label><input type="checkbox" />Tester la connexion CouchDB depuis le
navigateur</label></li>
<li><label><input type="checkbox" />Installer le plugin Obsidian
LiveSync</label></li>
</ul>
<h4 id="evening-1-2-hours">Soirée (1-2 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Connecter le client de bureau Obsidian à
CouchDB</label></li>
<li><label><input type="checkbox" />Tester la fonctionnalité de
synchronisation</label></li>
<li><label><input type="checkbox" />Documenter les étapes de configuration dans
Obsidian</label></li>
</ul>
<h3 id="sunday-schedule">Programme du dimanche</h3>
<h4 id="morning-2-3-hours-1">Matin (2-3 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Déployer le conteneur n8n</label></li>
<li><label><input type="checkbox" />Configurer l'authentification de base
n8n</label></li>
<li><label><input type="checkbox" />Explorer l'interface et les modèles
n8n</label></li>
</ul>
<h4 id="afternoon-2-3-hours-1">Après-midi (2-3 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Créer le premier flux de travail d'automatisation des
sauvegardes</label></li>
<li><label><input type="checkbox" />Tester la sauvegarde manuellement</label></li>
<li><label><input type="checkbox" />Configurer le calendrier de
sauvegarde</label></li>
</ul>
<h4 id="evening-1-2-hours-1">Soirée (1-2 heures)</h4>
<ul class="task-list">
<li><label><input type="checkbox" />Installer et configurer
Twingate</label></li>
<li><label><input type="checkbox" />Tester l'accès distant depuis un
téléphone/ordinateur portable</label></li>
<li><label><input type="checkbox" />Documenter l'ensemble de la configuration dans
Obsidian</label></li>
</ul>
<h2 id="end-goal-complete-self-hosted-environment">Objectif final :
Environnement auto-hébergé complet</h2>
<p>D'ici lundi, vous aurez :</p>
<h3 id="infrastructure">✅ Infrastructure</h3>
<ul>
<li>Hyperviseur Proxmox avec VMs organisées</li>
<li>Réseau sécurisé avec pare-feu pfSense</li>
<li>Architecture de services basée sur Docker</li>
</ul>
<h3 id="core-services">✅ Services de base</h3>
<ul>
<li>Synchronisation Obsidian auto-hébergée (CouchDB)</li>
<li>Plateforme d'automatisation n8n</li>
<li>Système de sauvegarde automatisé</li>
</ul>
<h3 id="security">✅ Sécurité</h3>
<ul>
<li>Accès distant sécurisé (Twingate)</li>
<li>Connexions chiffrées (HTTPS/SSL)</li>
<li>Sauvegardes automatisées régulières</li>
</ul>
<h3 id="automation">✅ Automatisation</h3>
<ul>
<li>Automatisation hebdomadaire des sauvegardes</li>
<li>Système de notification pour la surveillance</li>
<li>Base de flux de travail pour les projets futurs</li>
</ul>
<h2 id="next-steps-and-future-enhancements">Prochaines étapes et
améliorations futures</h2>
<h3 id="short-term-1-2-weeks">Court terme (1-2 semaines)</h3>
<ul>
<li>Ajouter un reverse proxy (Nginx Proxy Manager)</li>
<li>Configurer des noms de domaine personnalisés</li>
<li>Configurer la surveillance (Uptime Kuma)</li>
</ul>
<h3 id="medium-term-1-2-months">Moyen terme (1-2 mois)</h3>
<ul>
<li>Ajouter plus de flux de travail d'automatisation</li>
<li>Implémenter l'agrégation de logs (Loki + Grafana)</li>
<li>Créer un plan de reprise après sinistre</li>
</ul>
<h3 id="long-term-3-6-months">Long terme (3-6 mois)</h3>
<ul>
<li>Étendre le homelab avec des services supplémentaires</li>
<li>Implémenter GitOps pour l'infrastructure en tant que code</li>
<li>Créer une documentation complète</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Cette feuille de route offre un chemin clair, de la configuration initiale à un fully
fonctionnel, self-hosted homelab environment. En suivant cette approche par phases, vous construirez une base solide pour l'automatisation, la sécurité et l'apprentissage continu.</p>
<p>La clé du succès est un progrès constant et incrémental. Commencez par les bases, assurez-vous que chaque composant fonctionne correctement et ajoutez progressivement de la complexité. Documentez tout dans Obsidian, et n'hésitez pas à expérimenter et à apprendre des échecs.</p>
<p><em>Votre parcours homelab est un marathon, pas un sprint. Profitez du
processus !</em></p>
                </div>

                <div class="article-navigation">
                </div>
            </div>
        </section>
    </main>

    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>OLYAHYAI</h3>
                    <p>Pentester en formation | Passionné de cybersécurité</p>
                </div>

                <div class="footer-links">
                    <h4>Liens rapides</h4>
                    <ul>
                        <li><a href="/index.html#home">Accueil</a></li>
                        <li><a href="/index.html#about">À propos</a></li>
                        <li><a href="/index.html#projects">Projets</a></li>
                        <li><a href="/blog/index.html">Blog</a></li>
                    </ul>
                </div>

                <div class="footer-social">
                    <h4>Connectez-vous</h4>
                    <div class="social-links">
                        <a href="https://github.com/OLYAHYAI" target="_blank" rel="noopener">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://ma.linkedin.com/in/lyahyai-omar" target="_blank" rel="noopener">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="mailto:contact@olyahyai.com">
                            <i class="fas fa-envelope"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 OLYAHYAI. Tous droits réservés.</p>
                <p>Construit avec <i class="fas fa-heart"></i> et <i class="fas fa-terminal"></i></p>
            </div>
        </div>
    </footer>

    <button class="back-to-top" aria-label="Retour en haut">
        <i class="fas fa-chevron-up"></i>
    </button>

    <script src="../../js/main.js"></script>
    <script src="../../js/animations.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
---